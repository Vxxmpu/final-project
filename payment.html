<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Оплата услуги — Private Clinic</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="database/db-functions.js"></script>
  <style>
    :root { --bg: #f5fcff; --card-bg: #ffffff; --text: #1a3c34; --muted: #5f7a75; --accent:#26c6da; --accent-dark:#0097a7; --border:#b2ebf2; --shadow: 0 6px 20px rgba(38, 198, 218, 0.12); }
    *{ margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Roboto', sans-serif; background: var(--bg); color: var(--text); }
    .container{ max-width:1240px; margin:0 auto; padding:20px; }
    header{ position: sticky; top:0; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-bottom:1px solid var(--border); }
    nav{ display:flex; justify-content:space-between; align-items:center; padding:18px 0; }
    .logo{ font-size:1.6rem; font-weight:700; color:var(--accent-dark); }
    .logo span{ color:var(--accent); }
    main{ padding:40px 20px; }
    .card{ background:white; border-radius:12px; padding:24px; box-shadow:var(--shadow); max-width:720px; margin:0 auto; }
    label{ display:block; margin-bottom:8px; font-weight:500; }
    input, textarea{ width:100%; padding:12px; border:1px solid var(--border); border-radius:8px; margin-bottom:14px; }
    button{ padding:14px 20px; background:var(--accent); color:white; border:none; border-radius:50px; cursor:pointer; font-size:1rem; }
    footer{ text-align:center; padding:30px; color:var(--muted); border-top:1px solid var(--border); margin-top:40px; }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <nav>
        <a href="index.html" style="text-decoration:none;"><div class="logo">Private<span>Clinic</span></div></a>
        <div class="nav-actions">
          <a href="service-HTML/services.html" class="btn nav-btn">Услуги</a>
        </div>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="card">
      <h2>Оплатить услугу</h2>
      <p>Введите сумму и примечание (название услуги) — и подтвердите оплату через MetaMask.</p>

      <label for="payAmount">Сумма (CRT)</label>
      <input id="payAmount" type="number" step="0.0001" placeholder="Например: 10">

      <label for="payNote">Примечание / название услуги</label>
      <input id="payNote" type="text" placeholder="Например: Консультация">

      <button id="payNow">Оплатить</button>

      <p id="status" style="margin-top:12px;color:var(--accent);"></p>
      <p id="error" style="margin-top:8px;color:#e53935;"></p>
    </div>
  </main>

  <footer>© 2026 Private Clinic. Все права защищены.</footer>

  <script src="app.js"></script>
  <script>
    document.getElementById('payNow').addEventListener('click', async () => {
      const amount = document.getElementById('payAmount').value.trim();
      const note = document.getElementById('payNote').value.trim() || 'Оплата услуги';
      if (!amount || isNaN(amount)) { alert('Введите корректную сумму CRT'); return; }
      document.getElementById('status').innerText = 'Отправка транзакции...';
      document.getElementById('error').innerText = '';
      try {
        await payForService(amount, note);
        document.getElementById('status').innerText = 'Оплата успешно выполнена';
      } catch (err) {
        console.error(err);
        document.getElementById('error').innerText = err.reason || err.message || String(err);
        document.getElementById('status').innerText = '';
      }
    });
  </script>
</body>
</html>